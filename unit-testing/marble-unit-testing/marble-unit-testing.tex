\maketitle{}
\section{ Marble Unit Testing }

Unit testing observables, heck working with obserables is never really easy.
Primarily, it's not the logic one will come across in other parts of one's
application. As opposed ot regular logic, where one has the option to simply
console out logic and see what is there, then and there, one does not have that
option wih observables. Observables are a stream and in the context of
javascript it is an object that will a series of functions. In addition, an
Observable as a stream contains more than one snippet of data in it's entire
lifecycle.

\subsection{ Marble Unit Testing - A Primer }
Marble unit testing is a very efficient way of unit testing observables. It
keeps in mind the following:
\begin{enumerate}
  \item Recognizing that an observable stream can emit any number of values
  after a specific set of time.
  \item An observable is always observing until actually complete
  \item It can emit a number of different things at the same time, or at
  completely different times.
\end{enumerate}

\subsection{ Great Example }
Let's imagine that we get back a specific set of data as an observable. However,
within that set of data, we only want ids. Backend is tied, and they do not have
the capacity to give us a pre-poulated set of data for id. Our code will look
something like this:
\begin{lstlisting}
buyerIds$: Observable<string[]> = this.users$.pipe(
  map(users => {
    return users
      .map(user => {
        return user.id;
      })
  })
);
\end{lstlisting}

\subsubsection{Creating a unit test}
In our unit test, we would like to make sure that when we pass a set of data,
id's are indeed being extracted and returning a new array. We can do something
as follows using marble tests:

\begin{lstlisting
const buyersMock: Buyer[] = [
  {
    id: '123',
    name: 'Charlie',
  },
  {
    id: '246',
    name: 'Lisa',
  },
  {
    id: '369',
    name: 'Harley',
  },
];

it('should return buyer data for tier', () => {
  const expected$ = hot('(c|)', { c: ['123', '246', '369'] });

  expect(component.buyerTiers$).toBeObservable(expected$);
});
\end{lstlisting}
