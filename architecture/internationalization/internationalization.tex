\chapter{ Internationalization and Localization}

If not familiar with already, internationalization is the process of making sure
your app can be used by a worldwide audience. Localization, not to be confused 
with internatilization, is the process of changing app's text, to represent 
locale of user.

Internationalization is one of those things that is generally done farther down
the life cycle of an app. This makes complete sense, as when building a product, 
a team will generally want to build the infrastructure first, based on a 
particular language. Then, it will want to make it so that the app can be based 
on numerous different demographics. However, being aware of the following will 
make internationalization more of a seamless process. 

\section{General Concerns of Internationalization }

\begin{enumerate}
  \item What type of dates, numbers, perxentages and currencies do you want. 
  \item Setting aside text in components, so can be swapped out to the 
  appropriate language. 
  \item Plural words are different in different languages. So it's important 
  have something baked within the framework that does this. 
  \item Alternate text based on scenario(e.g. if person in New York display 
  such and such event, if person in San Francisco display message such and 
  such.)
\end{enumerate}

\section{General Concerns of Localization }
\begin{enumerate}
  \item Creating multiple language versions of app(will get to how that is done)
  \item Extracting Localizable text(not sure exactly what that is).
  \item Building and servimg an app for a given locale. 
\end{enumerate}

\section{Default Locale}
Localization for years, well before Angular, have been using ids for the 
applicaton to understand what the language should be. Angular, as well, has an
extensive list of different languages within it's framework. 

\mybox{Angular's internal framework uses the BCP47 norm. It's very important
to note that if you plan on building on top of Angular's localization framework,
that you use this as your standard within the framework. Specifications for BCP47 
change over time. However, this might not make a difference within your 
application, as this only happens to subset. }

Angular by default will use \lstinline{en-us} thereby once again solidifying 
the United States as the dominating world power. 

\section{i18n pipes}
Angular includes within the framework, the ability to use something called i18n 
pipes. i18n is an abbreviation of word "internationalization". It's perhaps the 
world's most clever abbreviation standing for "i plus eighteen letters, plus the 
letter n". 

\mybox{A DEC employee named Jan Scherpenhuizen was given an email account of 
S12n by a system administrator, since his name was too long to be an account 
name. This approach to abbreviating long names was intended to be humorous and
became generalized at DEC. The convention was applied to "internationalization"
at DEC which was using the numeronym by 1985. Use of the term spread. Searching
the net, we found uses on-line as early as 1989. It was being used on 
/usr/group, which evolved into UniForum. The X Window standards community was 
also using the abbreviation by 1989. Looking in printed texts, the earliest 
reference I could find was in the book Soft Landing in Japan, published by 
American Electronic Association, 1992.

The extension of this naming convention to the terms Localization (l10n), 
Europeanization (e13n), Japanization (j10n), Globalization (g11n), seemed to 
come somewhat after the invention of "i18n". The terms Canonicalization and 
Normalization, defined more recently, also have numeronym forms (c14n and n11n).
}

(Graphic goes here for internationalization)

There is no actual pipe actually called the "i18n" pipe. However, four pipes: 
\begin{enumerate}
  \item \lstinline{DatePipe}
  \item \lstinline{CurrencyPipe}
  \item \lstinline{DecimalPipe}
  \item \lstinline{PercentPipe}
\end{enumerate}

Do use the \lstinline{i18n} internal logic, and will automatically modify 
themselves based on the locale supplied within the app. As mentioned earlier,
Angular will only by default import \lstinline{en-US}. If you want to use other
languages within the app. 

\subsection{Import Locale Data for Other Languages}
If you would like to import data for other languages, import them locally 
within your \lstinline{app.module.ts} file. 

\begin{lstlisting}[caption=app.module.ts]
import { registerLocaleData } from '@angular/common';
import localeFr from '@angular/common/locales/fr';

// the second parameter 'fr' is optional
registerLocaleData(localeFr, 'fr');
\end{lstlisting}

\section{ Understanding Translation Process }
There are four steps to the Angular translation process: 
\begin{enumerate}
  \item It determines what is static text, so that it can be translated.
  \item Uses the internal Angular CLI \lstinline{i18n} command to transfer over 
  determined translatable text to an industry standard translation file. (Need 
  more information as to what this looks like.)
  \item Translates extracted text, into the target language. The dynamics of
  how this works, is that it edits the already existing file, to the targeted 
  language. 
  \item It then merges the translated file into the app, by replacing the 
  original untranslated text, with the new translated text. 
\end{enumerate}

\section{How to Make Content Translatable}
You might be wondering how to make content translatable. Angular intenrally 
allows for cotnent to be marked with the \lstinline{i18n} tag like such: 
\begin{lstlisting}
  <h1 i18n>i18n example</h1>
\end{lstlisting}

\mybox{It is important to note the i18n tag is not an Angular directive. It is 
a custom tag recognized by the Angular compiler, and will be removed once the
Angular compiler does it's magic.}

\subsection{Add a Description and a Meaning}
Angular also offers the ability to add a description and a meaning to the
\lstinline{i18n} tag. 
\begin{lstlisting}[caption=i18n description]
<h1 i18n="i18n tutorial text for internationalization chapter">i18n example</h1>
\end{lstlisting}

We can also add a meaning to the \lstinline{i18n} tag, in additon, to our 
already added description. The interface looks like this 
\lstinline{<meaning | description>}.

\begin{lstlisting}[caption=i18n \lstinline{<meaning | description>} Example]
<h1 i18n="tutorial text|i18n tutorial text for internationalization chapter">i18n example</h1>
\end{lstlisting}

You might be wondering how offering a meaning and description will make a 
difference with regards to the translation of the application. The Angular 
extraction tool preserves both meaning and description in the translation 
source file. When using only a meaning, or a description, the compiler will
preserve the meaning, or description with the compiled text. 

\subsubsection{Comibation of Meaning and Description}
However, the combiation of meaning and description within your app, will produce 
a specific id of a translation. With regards to the combination of meaning and 
description, meaning is the main identifier in this process. Only if the meaning 
is different, will the Angular compiler produce a different id. If, for instance, 
the meaning is the same, but the description is different, the compiler will 
still produce the same id. 

\section{Set a Custom ID for Persistance and Maintenance}
For each file that the Angular translator produces, it will by default attach 
an id to that file as well. It will look something like the following: 
\begin{lstlisting}[caption=example.fr.xlf.html]
<trans-unit id="ba01234d3d68bf669f97b8d96a4c5d8d9559aa3" datatype="html">
\end{lstlisting}

When the text is changed, the extractor tool will generate new text. You 
must then go ahead and manually change the id. \footnote{Not sure if this 
means that the text must be manually updated, or if compiler will do that
for you.} 

\subsection{Setting up Custom ID}
Angular will also allow you to set up a custom id for your translatable text:
\begin{lstlisting}
<h1 i18n="@@sampleText">i18n Sample</h1>
\end{lstlisting}

The custom id persists even when text changes. This allows for maintenance 
and scalability. Perhaps even the ability to hook an id into a content 
management system, and allow for an admin to control translation of different
parts of the application. 

\subsection{Using a Custom ID with a Description and/or Meaning}
There is also the option within the app to use a custom id with the 
description. 
\begin{lstlisting}[caption=custom id with description]
<h1 i18n="i18n tutorial text for internationalization chapter@@sampleText">i18n example</h1>
\end{lstlisting}

In addition, you can add meaning along with description to your custom id:
\begin{lstlisting}[caption=custom id with meaning and description]
<h1 i18n="tutorial text|i18n tutorial text for internationalization chapter@@sampleText">
  i18n example
</h1>
\end{lstlisting}

\mybox{Make sure to use unique custom ids for translation. If two of the same
ids are used for translation, Angular will only use the one which is meant to 
be used within your app. }

\subsection{Translating attributes}
Text can be contained inside of an attribute such as \lstinline{placeholder}, 
or \lstinline{title}. Due to the dynamics of how the \lstinline{i18n} compiler 
works, if you would like to translate the text within an attribute, you will 
have to use the \lstinline{i18n} flavored attribute. It follows the syntax of 
\lstinline{i18n-x} wherein \lstinline{x} is the name of the attribute you want
to translate. 

\begin{lstlisting}
<img [src]="logo" i18n-title title="Razroo logo" />
\end{lstlisting}

\section{ Regular Expressions - Pluralization | Selections }
Different languages treat the plural form of a word different ways. Angular 
offers a plural pipe out of the box. This is combination with \lstinline{i18n}
allows for a very sophisticated method with regards to internatilization. 

\begin{lstlisting}
<span i18n>Updated {minutes, plural, =0 {just now} =1 {one minute ago} other {{{minutes}} minutes ago}}</span>
\end{lstlisting}

The plural pipe, allows for the specification of the following categories: 
\begin{enumerate}
\item =0(or any other number)  
\item zero  
\item one
\item two
\item few
\item many
\item other
\end{enumerate}

In the above code, we are specifying: 
\begin{enumerate}
\item Just now if the numbers of minutes is 0 
\item "one minute ago" if the number of minutes is 1
\item and for every other amount we are specifying "x minutes ago" 
\end{enumerate}

By tagging in the \lstinline{i18n} attribute into our span element, we are 
translating the appropriate text based on the appropriate scenario. 

\subsection{Alternative Text Messages}
In addition to the scenario of plural text, another scenario to keep in mind, 
is when we want to select a certain text based on the variable provided. 

\begin{lstlisting}
<span i18n>The author is {gender, select, male {male} female {female} other {other}}</span>  
\end{lstlisting}

In the above text, based on whether, or not the author is a female, or male, or 
other, we will allow for a specific type of text to be displayed. In addition,
being that we are supplying the \lstinline{i18n} pipe to our app, this text 
will appropriately be changed to the correct text based on a certain localization.

\subsection{Alternative + Plural Combined}
There is also the option is combine plural and alternative text message capabilities 
together. 
\begin{lstlisting}
<span i18n>Updated: {minutes, plural,
=0 {just now}
=1 {one minute ago}
other {{{minutes}} minutes ago by {gender, select, male {male} female {female} other {other}}}}
</span>
\end{lstlisting}

As you can see in the above code, the other section, is combined with code for
select. Absolutely wonderful. 

\section{Translation Source File}
First and foremost, before describing how to create a translation source file,
let's discuss the purpose of a translation source file. The idea is, is that 
we have tagged all files that we would like to translate, with the \lstinline{i18n} 
attribute (which really isn't an attribute, and is more a compiler specific 
indicator, but I digress). After the source file is created, we have an xml 
specific file. It will look something like this: 
\begin{lstlisting}[caption=src/locale/messages.xlf]
<trans-unit id="introductionHeader" datatype="html">
  <source>Hello i18n!</source>
  <note priority="1" from="description">An introduction header for this sample</note>
  <note priority="1" from="meaning">User welcome</note>
</trans-unit>  
\end{lstlisting}

\section{Tips and Tricks}

\subsection{Using ng-container with i18n}
While something that might be obvious when thinking about it more, you can use 
\lstinline{ng-container} to remove the requirement of having an html element 
be created when translating text. E.g. 
\begin{lstlisting}
<ng-container i18n>Translate this into multiple languages</ng-container>
\end{lstlisting}

\section{ Architecting Internationalization }
The reason why architecting internationalization can be something that is
something for us to keep in mind, is that it can have an affect on how we might
view the architecture of our application. A data table, for instance, is a great
example. We might want to propose a rigid re-usable data-table. However, once
we introduce internationalization, having data tables that are unique per each
language will be important. Having a re-usable data table that takes care of
information through passing in props can be cumbsersome.

\section{ Smart and Dumb Components }
Creating smart and dumb components, is your most valuable resource when it comes
to internatilization. It will allow you to set up different components based on
certain languages. 
